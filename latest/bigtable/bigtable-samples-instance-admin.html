<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Bigtable C++ Client: Example: Instance Admin Samples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Bigtable C++ Client
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Bigtable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example: Instance Admin Samples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example is a very simple "Instance Admin" application, which illustrates how to:</p>
<ul>
<li>Create a production instance and run basic instance admin operations.</li>
<li>Create a development instance.</li>
<li>Delete an instance</li>
<li>Create a new cluster.</li>
<li>Delete a cluster.</li>
</ul>
<h2>Run the example</h2>
<p>This example uses the <a href="https://GoogleCloudPlatform.github.io/google-cloud-cpp">Cloud Bigtable C++ Client Library</a> to communicate with Cloud Bigtable.</p>
<p>To run the example program, follow the <a href="https://github.com/GoogleCloudPlatform/google-cloud-cpp/tree/master/google/cloud/bigtable/examples/">instructions</a> for the example on GitHub.</p>
<h3>Includ the Necessary Headers</h3>
<p>The example uses the following headers:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="instance__admin_8h.html">google/cloud/bigtable/instance_admin.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="instance__admin__client_8h.html">google/cloud/bigtable/instance_admin_client.h</a>&quot;</span></div></div><!-- fragment --> <h3>Connect to the Cloud Bigtable instance admin endpoint.</h3>
<div class="fragment"><div class="line">  google::cloud::bigtable::InstanceAdmin instance_admin(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a8a3eea1be7828d4afb6434f1ecc0b837">google::cloud::bigtable::CreateDefaultInstanceAdminClient</a>(</div><div class="line">          project_id, google::cloud::bigtable::ClientOptions()));</div></div><!-- fragment --> <h3>Create a production instance and run basic instance-operations.</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> RunInstanceOperations(</div><div class="line">    google::cloud::bigtable::InstanceAdmin instance_admin, <span class="keywordtype">int</span> argc,</div><div class="line">    <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;run: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="comment">// Create production instance</span></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      zone, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  google::cloud::bigtable::InstanceConfig config(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">      {{cluster_id.get(), cluster_config}});</div><div class="line">  config.set_type(google::cloud::bigtable::InstanceConfig::PRODUCTION);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Creating a PRODUCTION Instance: &quot;</span>;</div><div class="line">  <span class="keyword">auto</span> future = instance_admin.CreateInstance(config).get();</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// List Instances</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Instances: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances = instance_admin.ListInstances();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; instance : instances) {</div><div class="line">    std::cout &lt;&lt; instance.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// get Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Get Instance: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id.get());</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(instance, &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; std::endl &lt;&lt; instance_detail;</div><div class="line"></div><div class="line">  <span class="comment">// List clusters</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Clusters: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name: &quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Delete Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Deleting Instance: &quot;</span>;</div><div class="line">  instance_admin.DeleteInstance(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div></div><!-- fragment --> <h3>Create a Development Instance</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> CreateDevInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                       <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;create-dev-instance: &lt;instance-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string <span class="keyword">const</span> instance_id = ConsumeArg(argc, argv);</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line">  std::string cluster_id = instance_id + <span class="stringliteral">&quot;-c1&quot;</span>;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      zone, 0, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  google::cloud::bigtable::InstanceConfig config(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">      {{cluster_id, cluster_config}});</div><div class="line">  config.set_type(google::cloud::bigtable::InstanceConfig::DEVELOPMENT);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> future = instance_admin.CreateInstance(config);</div><div class="line">  <span class="comment">// Most applications would simply call future.get(), here we show how to</span></div><div class="line">  <span class="comment">// perform additional work while the long running operation completes.</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Waiting for instance creation to complete &quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 100; ++i) {</div><div class="line">    <span class="keywordflow">if</span> (std::future_status::ready == future.wait_for(std::chrono::seconds(2))) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;DONE: &quot;</span> &lt;&lt; future.get().name() &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    std::cout &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; std::flush;</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;TIMEOUT&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div></div><!-- fragment --> <h3>Delete an instance</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> DeleteInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                    <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;delete-instance: &lt;project-id&gt; &lt;instance-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string instance_id = ConsumeArg(argc, argv);</div><div class="line">  instance_admin.DeleteInstance(instance_id);</div><div class="line">}</div></div><!-- fragment --> <h3>Create an additional cluster on an existing instance</h3>
<div class="fragment"><div class="line"><span class="comment">// Before creating cluster, need to create a production instance first,</span></div><div class="line"><span class="comment">// then create cluster on it.</span></div><div class="line"><span class="keywordtype">void</span> CreateCluster(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{</div><div class="line">        <span class="stringliteral">&quot;create-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line"></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> location =</div><div class="line">      <span class="stringliteral">&quot;projects/&quot;</span> + instance_admin.project_id() + <span class="stringliteral">&quot;/locations/&quot;</span> + zone;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      location, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  <span class="keyword">auto</span> cluster =</div><div class="line">      instance_admin.CreateCluster(cluster_config, instance_id, cluster_id);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Created &quot;</span> &lt;&lt; cluster.get().name() &lt;&lt; std::endl;</div><div class="line">}</div></div><!-- fragment --> <h3>Delete a cluster</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> DeleteCluster(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;delete-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  instance_admin.DeleteCluster(instance_id, cluster_id);</div><div class="line">}</div></div><!-- fragment --> <h3>Put it all together</h3>
<p>Here is the full example</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="instance__admin_8h.html">google/cloud/bigtable/instance_admin.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="instance__admin__client_8h.html">google/cloud/bigtable/instance_admin_client.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;google/protobuf/text_format.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span>btproto = ::google::bigtable::admin::v2;</div><div class="line"></div><div class="line"><span class="keyword">namespace </span>{</div><div class="line"><span class="keyword">struct </span>Usage {</div><div class="line">  std::string msg;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">char</span> <span class="keyword">const</span>* ConsumeArg(<span class="keywordtype">int</span>&amp; argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc &lt; 2) {</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line">  }</div><div class="line">  <span class="keywordtype">char</span> <span class="keyword">const</span>* result = argv[1];</div><div class="line">  std::copy(argv + 2, argv + argc, argv + 1);</div><div class="line">  argc--;</div><div class="line">  <span class="keywordflow">return</span> result;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> PrintUsage(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[], std::string <span class="keyword">const</span>&amp; msg) {</div><div class="line">  std::string <span class="keyword">const</span> cmd = argv[0];</div><div class="line">  <span class="keyword">auto</span> last_slash = std::string(cmd).find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div><div class="line">  <span class="keyword">auto</span> program = cmd.substr(last_slash + 1);</div><div class="line">  std::cerr &lt;&lt; msg &lt;&lt; <span class="stringliteral">&quot;\nUsage: &quot;</span> &lt;&lt; program</div><div class="line">            &lt;&lt; <span class="stringliteral">&quot; &lt;command&gt; &lt;project_id&gt; [arguments]\n\n&quot;</span></div><div class="line">            &lt;&lt; <span class="stringliteral">&quot;Examples:\n&quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> example :</div><div class="line">       {<span class="stringliteral">&quot;run my-project my-instance my-cluster us-central1-f&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;create-dev-instance my-project my-instance us-central1-f&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;delete-instance my-project my-instance&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;create-cluster my-project my-instance my-cluster us-central1-a&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;delete-cluster my-project my-instance my-cluster&quot;</span>}) {</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; program &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; example &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">  }</div><div class="line">  std::cerr &lt;&lt; std::flush;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> CreateInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                    <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;create-instance: &lt;instance-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string <span class="keyword">const</span> instance_id = ConsumeArg(argc, argv);</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line">  std::string cluster_id = instance_id + <span class="stringliteral">&quot;-c1&quot;</span>;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      zone, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  google::cloud::bigtable::InstanceConfig config(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">      {{cluster_id, cluster_config}});</div><div class="line">  config.set_type(google::cloud::bigtable::InstanceConfig::PRODUCTION);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> future = instance_admin.CreateInstance(config);</div><div class="line">  <span class="comment">// Most applications would simply call future.get(), here we show how to</span></div><div class="line">  <span class="comment">// perform additional work while the long running operation completes.</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Waiting for instance creation to complete &quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 100; ++i) {</div><div class="line">    <span class="keywordflow">if</span> (std::future_status::ready == future.wait_for(std::chrono::seconds(2))) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;DONE: &quot;</span> &lt;&lt; future.get().name() &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    std::cout &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; std::flush;</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;TIMEOUT&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> CreateDevInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                       <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;create-dev-instance: &lt;instance-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string <span class="keyword">const</span> instance_id = ConsumeArg(argc, argv);</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line">  std::string cluster_id = instance_id + <span class="stringliteral">&quot;-c1&quot;</span>;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      zone, 0, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  google::cloud::bigtable::InstanceConfig config(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">      {{cluster_id, cluster_config}});</div><div class="line">  config.set_type(google::cloud::bigtable::InstanceConfig::DEVELOPMENT);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> future = instance_admin.CreateInstance(config);</div><div class="line">  <span class="comment">// Most applications would simply call future.get(), here we show how to</span></div><div class="line">  <span class="comment">// perform additional work while the long running operation completes.</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Waiting for instance creation to complete &quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != 100; ++i) {</div><div class="line">    <span class="keywordflow">if</span> (std::future_status::ready == future.wait_for(std::chrono::seconds(2))) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;DONE: &quot;</span> &lt;&lt; future.get().name() &lt;&lt; std::endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    std::cout &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; std::flush;</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;TIMEOUT&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> UpdateInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                    <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;update-instance: &lt;project-id&gt; &lt;instance-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string instance_id = ConsumeArg(argc, argv);</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id);</div><div class="line">  <span class="comment">// Modify the instance and prepare the mask with modified field</span></div><div class="line">  google::cloud::bigtable::InstanceUpdateConfig instance_update_config(</div><div class="line">      std::move(instance));</div><div class="line">  instance_update_config.set_display_name(<span class="stringliteral">&quot;Modified Display Name&quot;</span>);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> future =</div><div class="line">      instance_admin.UpdateInstance(std::move(instance_update_config));</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(future.get(), &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; instance_detail &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> ListInstances(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keyword">auto</span> instances = instance_admin.ListInstances();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; instance : instances) {</div><div class="line">    std::cout &lt;&lt; instance.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> GetInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                 <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;get-instance: &lt;project-id&gt; &lt;instance-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string instance_id = ConsumeArg(argc, argv);</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id);</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(instance, &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; instance_detail &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> DeleteInstance(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                    <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;delete-instance: &lt;project-id&gt; &lt;instance-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  std::string instance_id = ConsumeArg(argc, argv);</div><div class="line">  instance_admin.DeleteInstance(instance_id);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Before creating cluster, need to create a production instance first,</span></div><div class="line"><span class="comment">// then create cluster on it.</span></div><div class="line"><span class="keywordtype">void</span> CreateCluster(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{</div><div class="line">        <span class="stringliteral">&quot;create-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line"></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> location =</div><div class="line">      <span class="stringliteral">&quot;projects/&quot;</span> + instance_admin.project_id() + <span class="stringliteral">&quot;/locations/&quot;</span> + zone;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      location, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  <span class="keyword">auto</span> cluster =</div><div class="line">      instance_admin.CreateCluster(cluster_config, instance_id, cluster_id);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Created &quot;</span> &lt;&lt; cluster.get().name() &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> ListClusters(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                  <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;list-clusters &lt;project-id&gt; &lt;instance-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters(ConsumeArg(argc, argv));</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List&quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name:&quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> ListAllClusters(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                     <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 1) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;list-all-clusters &lt;project-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters();</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List&quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name:&quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> UpdateCluster(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;update-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <span class="comment">// CreateCluster or GetCluster first and then modify it</span></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      <span class="stringliteral">&quot;us-central1-f&quot;</span>, 0, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  <span class="keyword">auto</span> cluster =</div><div class="line">      instance_admin.CreateCluster(cluster_config, instance_id, cluster_id)</div><div class="line">          .get();</div><div class="line"></div><div class="line">  <span class="comment">// Modify the cluster</span></div><div class="line">  cluster.set_serve_nodes(2);</div><div class="line">  <span class="keyword">auto</span> modified_config =</div><div class="line">      google::cloud::bigtable::ClusterConfig(std::move(cluster));</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> modified_cluster = instance_admin.UpdateCluster(cluster_config).get();</div><div class="line"></div><div class="line">  std::string cluster_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(modified_cluster,</div><div class="line">                                              &amp;cluster_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;cluster details : &quot;</span> &lt;&lt; cluster_detail &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> GetCluster(google::cloud::bigtable::InstanceAdmin instance_admin, <span class="keywordtype">int</span> argc,</div><div class="line">                <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;get-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  <span class="keyword">auto</span> cluster = instance_admin.GetCluster(instance_id, cluster_id);</div><div class="line">  std::string cluster_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(cluster, &amp;cluster_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetCluster details : &quot;</span> &lt;&lt; cluster_detail &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> DeleteCluster(google::cloud::bigtable::InstanceAdmin instance_admin,</div><div class="line">                   <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 3) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;delete-cluster: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  instance_admin.DeleteCluster(instance_id, cluster_id);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RunInstanceOperations(</div><div class="line">    google::cloud::bigtable::InstanceAdmin instance_admin, <span class="keywordtype">int</span> argc,</div><div class="line">    <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{<span class="stringliteral">&quot;run: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="comment">// Create production instance</span></div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      zone, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  google::cloud::bigtable::InstanceConfig config(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">      {{cluster_id.get(), cluster_config}});</div><div class="line">  config.set_type(google::cloud::bigtable::InstanceConfig::PRODUCTION);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Creating a PRODUCTION Instance: &quot;</span>;</div><div class="line">  <span class="keyword">auto</span> future = instance_admin.CreateInstance(config).get();</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// List Instances</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Instances: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances = instance_admin.ListInstances();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; instance : instances) {</div><div class="line">    std::cout &lt;&lt; instance.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// get Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Get Instance: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id.get());</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(instance, &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; std::endl &lt;&lt; instance_detail;</div><div class="line"></div><div class="line">  <span class="comment">// List clusters</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Clusters: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name: &quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Delete Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Deleting Instance: &quot;</span>;</div><div class="line">  instance_admin.DeleteInstance(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// This full example demonstrate various instance operations</span></div><div class="line"><span class="comment">// by initially creating production instance</span></div><div class="line"><span class="keywordtype">void</span> RunFullExample1(std::string project_id, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 6) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{</div><div class="line">        <span class="stringliteral">&quot;run-full-example-1: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id-1&gt; &quot;</span></div><div class="line">        <span class="stringliteral">&quot;&lt;zone-1&gt; &lt;cluster-id-2&gt; &lt;zone-2&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id_1(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone_1 = ConsumeArg(argc, argv);</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id_2(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone_2 = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="comment">// [START connect_instance_admin]</span></div><div class="line">  <span class="comment">// Create an instance admin endpoint.</span></div><div class="line">  google::cloud::bigtable::InstanceAdmin instance_admin(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a8a3eea1be7828d4afb6434f1ecc0b837">google::cloud::bigtable::CreateDefaultInstanceAdminClient</a>(</div><div class="line">          project_id, google::cloud::bigtable::ClientOptions()));</div><div class="line">  <span class="comment">// [END connect_instance_admin]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_check_instance_exists]</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Check Instance exists: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances = instance_admin.ListInstances();</div><div class="line">  <span class="keyword">auto</span> instance_name =</div><div class="line">      instance_admin.project_name() + <span class="stringliteral">&quot;/instances/&quot;</span> + instance_id.get();</div><div class="line">  <span class="keywordtype">bool</span> instanceExists =</div><div class="line">      instances.end() !=</div><div class="line">      std::find_if(</div><div class="line">          instances.begin(), instances.end(),</div><div class="line">          [&amp;instance_name](<a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a6fd9b4a69047dfdcd3e57799ff905a8a">google::bigtable::admin::v2::Instance</a> <span class="keyword">const</span>&amp; i) {</div><div class="line">            <span class="keywordflow">return</span> i.name() == instance_name;</div><div class="line">          });</div><div class="line">  <span class="comment">// [END bigtable_check_instance_exists]</span></div><div class="line"></div><div class="line">  <span class="comment">// Create instance if does not exists</span></div><div class="line">  <span class="keywordflow">if</span> (not instanceExists) {</div><div class="line">    <span class="comment">// [START bigtable_create_prod_instance]</span></div><div class="line">    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Creating a PRODUCTION Instance: &quot;</span>;</div><div class="line">    <span class="comment">// Create production instance</span></div><div class="line">    <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">// production instance needs at least 3 nodes</span></div><div class="line">    <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">        zone_1, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">    google::cloud::bigtable::InstanceConfig config(</div><div class="line">        <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">        {{cluster_id_1.get(), cluster_config}});</div><div class="line">    config.set_type(google::cloud::bigtable::InstanceConfig::PRODUCTION);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> future = instance_admin.CreateInstance(config).get();</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">    <span class="comment">// [END bigtable_create_prod_instance]</span></div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    std::cout &lt;&lt; std::endl</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot;Instance &quot;</span> &lt;&lt; instance_id.get() &lt;&lt; <span class="stringliteral">&quot; already exists.&quot;</span></div><div class="line">              &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_list_instance]</span></div><div class="line">  <span class="comment">// List Instances</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Instances: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances_after = instance_admin.ListInstances();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; instance : instances_after) {</div><div class="line">    std::cout &lt;&lt; instance.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">  <span class="comment">// [END bigtable_list_instance]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_get_instance]</span></div><div class="line">  <span class="comment">// get Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Get Instance: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id.get());</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(instance, &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; std::endl &lt;&lt; instance_detail;</div><div class="line">  <span class="comment">// [END bigtable_get_instance]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_list_cluster]</span></div><div class="line">  <span class="comment">// List clusters</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Clusters: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name: &quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">  <span class="comment">// [END bigtable_list_cluster]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_create_cluster]</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Adding Cluster: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> location =</div><div class="line">      <span class="stringliteral">&quot;projects/&quot;</span> + instance_admin.project_id() + <span class="stringliteral">&quot;/locations/&quot;</span> + zone_2;</div><div class="line">  <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">      location, 3, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">  <span class="keyword">auto</span> cluster =</div><div class="line">      instance_admin.CreateCluster(cluster_config, instance_id, cluster_id_2);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Created &quot;</span> &lt;&lt; cluster.get().name() &lt;&lt; std::endl;</div><div class="line">  <span class="comment">// [END bigtable_create_cluster]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_delete_cluster]</span></div><div class="line">  <span class="comment">// Delete Cluster</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Deleting Cluster: &quot;</span>;</div><div class="line">  instance_admin.DeleteCluster(instance_id, cluster_id_2);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="comment">// [END bigtable_delete_cluster]</span></div><div class="line"></div><div class="line">  <span class="comment">// [START bigtable_delete_instance]</span></div><div class="line">  <span class="comment">// Delete Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Deleting Instance: &quot;</span>;</div><div class="line">  instance_admin.DeleteInstance(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="comment">// [END bigtable_delete_instance]</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// This full example demonstrate various instance operations</span></div><div class="line"><span class="comment">// by initially creating development instance</span></div><div class="line"><span class="keywordtype">void</span> RunFullExample2(std::string project_id, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div><div class="line">    <span class="keywordflow">throw</span> Usage{</div><div class="line">        <span class="stringliteral">&quot;run-full-example-1: &lt;project-id&gt; &lt;instance-id&gt; &lt;cluster-id&gt; &lt;zone&gt;&quot;</span>};</div><div class="line">  }</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a> instance_id(ConsumeArg(argc, argv));</div><div class="line">  <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a73d20496d86761052e55848775b1e30b">google::cloud::bigtable::ClusterId</a> cluster_id(ConsumeArg(argc, argv));</div><div class="line">  std::string <span class="keyword">const</span> zone = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="comment">// Create an instance admin endpoint.</span></div><div class="line">  google::cloud::bigtable::InstanceAdmin instance_admin(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a8a3eea1be7828d4afb6434f1ecc0b837">google::cloud::bigtable::CreateDefaultInstanceAdminClient</a>(</div><div class="line">          project_id, google::cloud::bigtable::ClientOptions()));</div><div class="line"></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Check Instance exists: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances = instance_admin.ListInstances();</div><div class="line">  <span class="keyword">auto</span> instance_name =</div><div class="line">      instance_admin.project_name() + <span class="stringliteral">&quot;/instances/&quot;</span> + instance_id.get();</div><div class="line">  <span class="keywordtype">bool</span> instanceExists =</div><div class="line">      instances.end() !=</div><div class="line">      std::find_if(</div><div class="line">          instances.begin(), instances.end(),</div><div class="line">          [&amp;instance_name](<a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a6fd9b4a69047dfdcd3e57799ff905a8a">google::bigtable::admin::v2::Instance</a> <span class="keyword">const</span>&amp; i) {</div><div class="line">            <span class="keywordflow">return</span> i.name() == instance_name;</div><div class="line">          });</div><div class="line">  <span class="comment">// Create instance if does not exists</span></div><div class="line">  <span class="keywordflow">if</span> (not instanceExists) {</div><div class="line">    <span class="comment">// [START bigtable_create_dev_instance]</span></div><div class="line">    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Creating a DEVELOPMENT Instance: &quot;</span>;</div><div class="line">    <span class="comment">// Create development instance</span></div><div class="line">    <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aeb2a52a19595444371d7dc12350d3f63">google::cloud::bigtable::DisplayName</a> display_name(<span class="stringliteral">&quot;Put description here&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> cluster_config = google::cloud::bigtable::ClusterConfig(</div><div class="line">        zone, 0, google::cloud::bigtable::ClusterConfig::HDD);</div><div class="line">    google::cloud::bigtable::InstanceConfig config(</div><div class="line">        <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#aa9a2503f014b52ebb4ba4b2651070d71">google::cloud::bigtable::InstanceId</a>(instance_id), display_name,</div><div class="line">        {{cluster_id.get(), cluster_config}});</div><div class="line">    config.set_type(google::cloud::bigtable::InstanceConfig::DEVELOPMENT);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> future = instance_admin.CreateInstance(config).get();</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">    <span class="comment">// [END bigtable_create_dev_instance]</span></div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    std::cout &lt;&lt; std::endl</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot;Instance &quot;</span> &lt;&lt; instance_id.get() &lt;&lt; <span class="stringliteral">&quot; already exists.&quot;</span></div><div class="line">              &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// List Instances</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Instances: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instances_after = instance_admin.ListInstances();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; instance : instances_after) {</div><div class="line">    std::cout &lt;&lt; instance.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// get Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Get Instance: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> instance = instance_admin.GetInstance(instance_id.get());</div><div class="line">  std::string instance_detail;</div><div class="line">  google::protobuf::TextFormat::PrintToString(instance, &amp;instance_detail);</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;GetInstance details : &quot;</span> &lt;&lt; std::endl &lt;&lt; instance_detail;</div><div class="line"></div><div class="line">  <span class="comment">// List clusters</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Listing Clusters: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keyword">auto</span> cluster_list = instance_admin.ListClusters(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name List: &quot;</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cluster : cluster_list) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Cluster Name: &quot;</span> &lt;&lt; cluster.name() &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Delete Instance</span></div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Deleting Instance: &quot;</span>;</div><div class="line">  instance_admin.DeleteInstance(instance_id.get());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; Done&quot;</span> &lt;&lt; std::endl;</div><div class="line">}</div><div class="line"></div><div class="line">}  <span class="comment">// anonymous namespace</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="bigtable__hello__world_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) <span class="keyword">try</span> {</div><div class="line">  <span class="keywordflow">if</span> (argc &lt; 3) {</div><div class="line">    PrintUsage(argc, argv, <span class="stringliteral">&quot;Missing command&quot;</span>);</div><div class="line">    <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line"></div><div class="line">  std::string <span class="keyword">const</span> command = ConsumeArg(argc, argv);</div><div class="line">  std::string <span class="keyword">const</span> project_id = ConsumeArg(argc, argv);</div><div class="line"></div><div class="line">  <span class="comment">// Create an instance admin endpoint.</span></div><div class="line"><span class="comment"></span>  google::cloud::bigtable::InstanceAdmin instance_admin(</div><div class="line">      <a class="code" href="namespacegoogle_1_1cloud_1_1bigtable_1_1v0.html#a8a3eea1be7828d4afb6434f1ecc0b837">google::cloud::bigtable::CreateDefaultInstanceAdminClient</a>(</div><div class="line">          project_id, google::cloud::bigtable::ClientOptions()));</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;run&quot;</span>) {</div><div class="line">    RunInstanceOperations(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;create-instance&quot;</span>) {</div><div class="line">    CreateInstance(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;create-dev-instance&quot;</span>) {</div><div class="line">    CreateDevInstance(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;update-instance&quot;</span>) {</div><div class="line">    UpdateInstance(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;list-instances&quot;</span>) {</div><div class="line">    ListInstances(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;get-instance&quot;</span>) {</div><div class="line">    GetInstance(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;delete-instance&quot;</span>) {</div><div class="line">    DeleteInstance(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;create-cluster&quot;</span>) {</div><div class="line">    CreateCluster(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;list-clusters&quot;</span>) {</div><div class="line">    ListClusters(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;list-all-clusters&quot;</span>) {</div><div class="line">    ListAllClusters(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;update-cluster&quot;</span>) {</div><div class="line">    UpdateCluster(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;get-cluster&quot;</span>) {</div><div class="line">    GetCluster(instance_admin, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;delete-cluster&quot;</span>) {</div><div class="line">    DeleteCluster(instance_admin, argc, argv);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;run-full-example-1&quot;</span>) {</div><div class="line">    RunFullExample1(project_id, argc, argv);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">if</span> (command == <span class="stringliteral">&quot;run-full-example-2&quot;</span>) {</div><div class="line">    RunFullExample2(project_id, argc, argv);</div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    std::string msg(<span class="stringliteral">&quot;Unknown_command: &quot;</span> + command);</div><div class="line">    PrintUsage(argc, argv, msg);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">} <span class="keywordflow">catch</span> (Usage <span class="keyword">const</span>&amp; ex) {</div><div class="line">  PrintUsage(argc, argv, ex.msg);</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">} <span class="keywordflow">catch</span> (std::exception <span class="keyword">const</span>&amp; ex) {</div><div class="line">  std::cerr &lt;&lt; <span class="stringliteral">&quot;Standard C++ exception raised: &quot;</span> &lt;&lt; ex.what() &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><code>bigtable::v0::InstanceAdmin</code> for additional operations to get, list, update, and delete instances. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
